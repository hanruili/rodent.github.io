<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>regression_models.knit</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Rodent Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Report.html">Report</a>
    </li>
    <li>
      <a href="data_clean.html">Data Cleaning</a>
    </li>
    <li>
      <a href="Rat_region.html">Rat Region</a>
    </li>
    <li>
      <a href="rodent_activity.html">Rat Activity</a>
    </li>
    <li>
      <a href="regression_models.html">Regression Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="shiny_apps.html">Shiny App</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<p>title: “Regression Models: Explaining Rodent Activity” output:
html_document —</p>
<p>author: “Yujing Fu, Hanrui Li” date: “2024-11-30” output:
html_document —</p>
<pre class="r"><code>library(tidyverse)
library(dplyr)
library(ggplot2)
library(lubridate)
library(tidyr)
library(rvest)
library(janitor)
library(modelr)</code></pre>
<pre class="r"><code># data import 
rat_df = read.csv(&quot;data/rat_2020_2024.csv&quot;)
food_scrap_df = 
  read.csv(&quot;data/food_scrap_drop_off.csv&quot;)
zhvi_df = read.csv(&quot;data/ny_zhvi_df_2020_2024.csv&quot;)
zori_df = read.csv(&quot;data/ny_zori_df_2020_2024.csv&quot;)</code></pre>
<pre class="r"><code># clean rat data
rat_tidydf = rat_df |&gt; 
  mutate(inspection_date = substring(inspection_date, 1, 10)) |&gt; 
  mutate(date = as.Date(inspection_date, format = &quot;%m/%d/%Y&quot;)) |&gt; 
  mutate(year = as.numeric(format(date, &quot;%Y&quot;))) |&gt; 
  mutate(month = as.numeric(format(date, &quot;%m&quot;))) |&gt; 
  mutate(day = as.numeric(format(date, &quot;%d&quot;))) |&gt; 
  select(inspection_type, result, date, year, month, day, street_name, zip_code, borough,latitude, longitude, location)</code></pre>
<pre class="r"><code># clean zhvi and zori data
zhvi_tidydf =
  zhvi_df |&gt; 
  janitor::clean_names() |&gt; 
  mutate(region_name=as.numeric(region_name)) |&gt; # Convert the data type to numeric
  rename(zip_code = region_name, county = county_name) |&gt; # Rename &#39;region_name&#39; to &#39;zip_code&#39;
  mutate(county = gsub(&quot; County&quot;, &quot;&quot;, county)) |&gt; 
  pivot_longer(
    cols = starts_with(&quot;x20&quot;), 
    names_to = &quot;date&quot;, 
    values_to = &quot;house_price&quot;) |&gt;  
  mutate(date = as.Date(gsub(&quot;^x&quot;, &quot;&quot;, date), format = &quot;%Y_%m_%d&quot;)) |&gt; # Remove &#39;x&#39; from date and convert to Date format
  mutate(year = as.numeric(format(date, &quot;%Y&quot;))) |&gt; # Extract the year from the date
  mutate(month = as.numeric(format(date, &quot;%m&quot;))) |&gt; # Extract the month from the date
  select(zip_code, county, date, year, month, house_price) |&gt; # Select relevant columns
  drop_na() # Remove rows with missing values for data quality

# Clean and transform ZORI (rental price) dataset
zori_tidydf = 
  zori_df |&gt; 
  janitor::clean_names() |&gt; # Standardize column names to clearer version
  rename(zip_code = region_name, county = county_name) |&gt; # Rename &#39;region_name&#39; to &#39;zip_code&#39;
  mutate(county = gsub(&quot; County&quot;, &quot;&quot;, county)) |&gt; 
  pivot_longer(
    cols = starts_with(&quot;x20&quot;), 
    names_to = &quot;date&quot;, 
    values_to = &quot;rental_price&quot;) |&gt; 
  mutate(date = as.Date(gsub(&quot;^x&quot;, &quot;&quot;, date), format = &quot;%Y_%m_%d&quot;)) |&gt; # Remove &#39;x&#39; from date and convert to Date format
  mutate(year = as.numeric(format(date, &quot;%Y&quot;))) |&gt; 
  mutate(month = as.numeric(format(date, &quot;%m&quot;))) |&gt;
  select(zip_code, county, date, year, month, rental_price) |&gt; # Select necessary columns
  drop_na() # Remove rows with missing values</code></pre>
<pre class="r"><code># zip code df
url = &quot;https://p8105.com/data/zip_codes.html&quot;
zip_code_html = read_html(url)

zip_code_df =
  zip_code_html |&gt; 
  html_table() |&gt; 
  as.data.frame() |&gt; 
  janitor::clean_names() |&gt; 
  mutate(borough = case_when(
    county == &quot;Bronx&quot; ~ &quot;Bronx&quot;,
    county == &quot;Kings&quot; ~ &quot;Brooklyn&quot;,
    county == &quot;New York&quot; ~ &quot;Manhattan&quot;,
    county == &quot;Queens&quot; ~ &quot;Queens&quot;,
    county == &quot;Richmond&quot; ~ &quot;Staten Island&quot;,
    TRUE ~ &quot;Other&quot;
  )) |&gt; 
  select(zip_code, county, neighborhood, borough) |&gt; 
  drop_na()</code></pre>
<pre class="r"><code># merge the zori &amp; zhvi with zip code based on both the `zip_code` and `county`
zori_merged = left_join(zori_tidydf, zip_code_df, by = c(&quot;zip_code&quot;, &quot;county&quot;)) |&gt; 
  select(-date)
zhvi_merged = left_join(zhvi_tidydf, zip_code_df, by = c(&quot;zip_code&quot;, &quot;county&quot;)) |&gt; 
  select(-date)</code></pre>
<pre class="r"><code># merge the zillow information
zillow_merged = merge(zori_merged, zhvi_merged, by = c(&quot;zip_code&quot;, &quot;county&quot;, &quot;borough&quot;, &quot;neighborhood&quot;, &quot;year&quot;, &quot;month&quot;)) |&gt; 
  drop_na()</code></pre>
<pre class="r"><code># define the binary variable of rodent activity
rodent_reg =
  rat_tidydf |&gt; 
  mutate(rodent_bi = case_when(
    result == &quot;Rat Activity&quot; ~ 1,
    TRUE ~ 0
  )) </code></pre>
<pre class="r"><code>rodent_reg_merged = 
  left_join(zillow_merged, rodent_reg, by = c(&quot;zip_code&quot;, &quot;borough&quot;, &quot;year&quot;, &quot;month&quot;))</code></pre>
<div id="data-analysis" class="section level1">
<h1>Data Analysis</h1>
<p><strong>rodent_bi = 1</strong>: Indicates “Rat Activity” was found
during the inspection. This means that there was a confirmed presence of
rodent activity at the inspected location.</p>
<p><strong>rodent_bi = 0</strong>: Indicates “No Rat Activity” or any
other result different from “Rat Activity”. This means there was no
confirmed rodent activity at the inspected location.</p>
<div
id="is-the-rental-price-of-houses-significantly-related-to-the-rodent-activity"
class="section level2">
<h2>Is the rental price of houses significantly related to the rodent
activity?</h2>
<pre class="r"><code># Logistic Regression: Rental Price vs Rodent Activity
model1 &lt;- glm(rodent_bi ~ rental_price, family = binomial, data = rodent_reg_merged)

# Creating Regression Model Table
model1 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.7659535537</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rental_price</td>
<td align="right">0.0000779043</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[log[\frac{P(\text{rodent activity} =
1)}{1 - P(\text{rodent activity} = 1)}] = -0.766 + 0.0000779 \times
\text{rental price}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(P(\text{rodent activity} = 1))\)</span>
is the probability of observing rodent activity.</li>
<li><span class="math inline">\(\text{log}(\frac{P}{1-P})\)</span> is
the log-odds of rodent activity.</li>
</ul>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> -0.766</p>
<p>This represents the log-odds of rodent activity when the rental price
is 0.</p>
<ul>
<li>Since the intercept value is negative (<span
class="math inline">\(\beta_0 = -0.766\)</span>), the log-odds of rodent
activity are less than zero when the rental price is 0.</li>
<li>Odds = <span class="math inline">\(e^{\beta_0} = e^{-0.766} \approx
0.465\)</span>. This implies that, when the rental price is 0, the odds
of rodent activity are approximately 0.465:1, meaning it’s less likely
than not.</li>
</ul>
<p><strong>Coefficient for <code>rental_price</code> (<span
class="math inline">\(\beta_1\)</span>):</strong> 0.0000779</p>
<p>The coefficient represents the change in the log-odds of rodent
activity for a one-unit increase in the rental price.</p>
<ul>
<li>For every one-unit increase in the rental price, the log-odds of
rodent activity increase by 0.0000779.</li>
<li>Odds Ratio = <span class="math inline">\(e^{\beta_1} = e^{0.0000779}
\approx 1\)</span>. This indicates that a small increase in rental price
slightly increases the odds of rodent activity.</li>
</ul>
<p><strong>Statistical Significance:</strong></p>
<p>Both p-values for the intercept and coefficient are &lt;2e-16 <span
class="math inline">\(\approx\)</span> 0, meaning they are statistically
significant at any common significance level (e.g., <span
class="math inline">\(\alpha = 0.05\)</span>). This suggests that both
the intercept and the effect of rental price on rodent activity are
statistically significant.</p>
<p><strong>Summary:</strong></p>
<ul>
<li>Rental price has a statistically significant but very small positive
relationship with rodent activity. While significant, the effect size is
negligible, meaning rental price is not a strong predictor of rodent
activity.</li>
<li>This suggests that other factors likely play a more significant role
in determining rodent activity in the dataset.</li>
</ul>
</div>
<div
id="is-the-value-of-houses-significantly-related-to-the-rodent-activity"
class="section level2">
<h2>Is the value of houses significantly related to the rodent
activity?</h2>
<pre class="r"><code># Logistic Regression: House Value vs Rodent Activity
model2 = glm(rodent_bi ~ house_price, family = binomial, data = rodent_reg_merged)

# Creating Regression Model Table
model2 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.4510699</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">house_price</td>
<td align="right">-0.0000001</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[log[\frac{P(\text{rodent activity} =
1)}{1 - P(\text{rodent activity} = 1)}] = -0.451 + (-0.0000001) \times
\text{house value}\]</span></p>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> -0.451</p>
<p>This represents the log-odds of rodent activity when the house value
is 0.</p>
<ul>
<li>Since <code>house_price</code> = 0 is unrealistic (as house prices
cannot be zero), the intercept primarily serves as a baseline log-odds
for the model.</li>
<li>Odds = <span class="math inline">\(e^{\beta_0} = e^{-0.451} \approx
0.637\)</span>. This means that the odds of rodent activity are
approximately 0.637:1 when house price is 0 (hypothetically).</li>
</ul>
<p><strong>Coefficient for <code>rental_price</code> (<span
class="math inline">\(\beta_1\)</span>):</strong> -0.0000001</p>
<p>The coefficient indicates the change in log-odds of rodent activity
for a one-unit increase in house price.</p>
<ul>
<li>For each one-unit increase in house price, the log-odds of rodent
activity decrease by 0.0000001.</li>
<li>Odds Ratio = <span class="math inline">\(e^{\beta_1} =
e^{-0.0000001} \approx 1\)</span>. This suggests that an increase in
house price very slightly reduces the odds of rodent activity. However,
the effect size is extremely small and likely negligible in practical
terms.</li>
</ul>
<p><strong>Statistical Significance:</strong></p>
<p>Both p-values for the intercept and coefficient <span
class="math inline">\(\approx\)</span> 0, meaning they are statistically
significant at any common significance level (e.g., <span
class="math inline">\(\alpha = 0.05\)</span>). This means the
relationship between house price and rodent activity is statistically
significant, but the effect size is so small that it has little
practical importance.</p>
<p><strong>Summary:</strong></p>
<ul>
<li>Higher house prices are slightly associated with lower rodent
activity, but the effect is negligible.</li>
<li>While statistically significant, the effect size is so small that
house price is unlikely to be a meaningful predictor of rodent activity.
Other variables are likely more important in explaining the variation in
rodent activity.</li>
</ul>
</div>
<div
id="is-borough-a-confounder-on-the-relationship-between-rodent-activity-and-rental-price-also-between-rodent-activity-and-house-value"
class="section level2">
<h2>Is borough a confounder on the relationship between rodent activity
and rental price? (Also between rodent activity and house value?)</h2>
<div id="is-borough-significantly-related-to-the-rental-price"
class="section level3">
<h3>Is borough significantly related to the rental price?</h3>
<pre class="r"><code>#Linear regression model: rental price and borough
model3 &lt;- lm(rental_price ~ borough, data = rodent_reg_merged)

# Creating Regression Model Table
model3 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2100.02902</td>
<td align="right">0.0000000000</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">805.84709</td>
<td align="right">0.0000000000</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">1148.49080</td>
<td align="right">0.0000000000</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">379.75174</td>
<td align="right">0.0000000000</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">45.97548</td>
<td align="right">0.0002538912</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\text{rental price} = 2100.03 +
805.85\times \text{Brooklyn} + 1148.49\times \text{Manhattan} +
379.75\times \text{Queens} + 45.98\times \text{Staten Island}\]</span>
Where:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: Intercept (average
rental price in the reference category, Bronx).</li>
<li><span class="math inline">\(\beta_{1,2,3,4}\)</span>: Coefficients
for the borough dummy variables. These represent the difference in
average rental price between each borough and the Bronx.</li>
</ul>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> 2100.03</p>
<p>This represents the average rental price in the Bronx (the reference
borough).</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{1,2,3,4}\)</span>):</strong></p>
<p>This indicates how much the average rental price in each borough
(Brooklyn, Manhattan, Queens, Staten Island) is higher than in the
Bronx. All are positive.</p>
<p><strong>Statistical Significance:</strong></p>
<p>The overall p-value for the model (p &lt; 2e-16) indicates that
borough is significantly related to rental price. The p-values for each
borough relative to the reference category (Bronx) are all statistically
significant (p &lt; 0.001), meaning rental prices differ significantly
across boroughs.</p>
<p><strong>Summary:</strong></p>
<p>Borough is significantly related to rental price, with notable
differences in average rental prices across boroughs.</p>
</div>
<div id="is-borough-significantly-related-to-the-rodent-activity"
class="section level3">
<h3>Is borough significantly related to the rodent activity?</h3>
<pre class="r"><code>#Regression model: rodent activity and borough
model4 &lt;- glm(rodent_bi ~ borough, data = rodent_reg_merged)

# Creating Regression Model Table
model4 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.44100985</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">-0.08470251</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">-0.03503736</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">-0.16305830</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">-0.34428366</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\text{rodent
activity}=0.441+(−0.0847)\times \text{Brooklyn}+(−0.0350)\times
\text{Manhattan}+(−0.1631)\text{Queens}+(−0.3443)\times
\text{StatenIsland}\]</span> Where:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: Intercept (baseline
probability of rodent activity in the reference borough, Bronx).</li>
<li><span class="math inline">\(\beta_{1,2,3,4}\)</span>: Coefficients
representing the difference in rodent activity between each borough and
the Bronx.</li>
</ul>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> 0.441</p>
<p>This represents the baseline probability of rodent activity in the
Bronx (the reference category).</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{1,2,3,4}\)</span>):</strong></p>
<p>The coefficient for each borough (Brooklyn, Manhattan, Queens, Staten
Island) represents the difference in the average probability of rodent
activity between each borough and the Bronx. For example, the
probability of rodent activity in Brooklyn is 0.0847 lower than in the
Bronx.</p>
<p><strong>Statistical Significance:</strong></p>
<p>All coefficients, including the intercept, have p &lt; 0.001,
indicating that the differences in rodent activity probabilities across
boroughs are statistically significant.</p>
<p><strong>Summary:</strong></p>
<p>Borough is significantly related to rodent activity.</p>
</div>
<div id="regression-model-with-both-borough-and-rental-price"
class="section level3">
<h3>Regression model with both borough and rental price</h3>
<pre class="r"><code>#Regression model testing for confounding
model5 &lt;- glm(rodent_bi ~ borough + rental_price, data = rodent_reg_merged)

# Creating Regression Model Table
model5 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.4179050705</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">-0.0935738820</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">-0.0476417252</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">-0.1672550224</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">-0.3447959091</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">rental_price</td>
<td align="right">0.0000110014</td>
<td align="right">6.13e-08</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\text{rodent acticvity} =
0.4179+(−0.0936)\times \text{Brooklyn}+(−0.0476)\times
\text{Manhattan}+(−0.1673)\times \text{Queens}+(−0.3448)\times
\text{Staten Island}+(0.000011)\times \text{rental price}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\beta_0:\)</span> Intercept (baseline
probability of rodent activity in the Bronx with rental price = 0).</li>
<li><span class="math inline">\(\beta_{1,2,3,4}:\)</span> Coefficients
for boroughs (relative to Bronx).</li>
<li><span class="math inline">\(\beta_5:\)</span> Coefficient for rental
price, indicating how rental price impacts rodent activity.</li>
</ul>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> 0.4179</p>
<p>The intercept represents the baseline probability of rodent activity
in the Bronx when rental price is 0.</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{1,2,3,4}\)</span>):</strong></p>
<p>These coefficients represent the difference in probability of rodent
activity between each borough and the Bronx (the reference borough).</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{5}\)</span>):</strong> 0.000011</p>
<p>Rental price has a small positive effect on the probability of rodent
activity.</p>
<p><strong>Statistical Significance:</strong></p>
<p>All predictors, including boroughs and rental price, are
statistically significant (p &lt; 0.001). This suggests that both
borough and rental price significantly contribute to the prediction of
rodent activity.</p>
<p><strong>Summary:</strong></p>
<p>Borough remains a strong predictor of rodent activity. Rental price
is also a significant predictor.</p>
</div>
<div id="is-borough-significantly-related-to-the-house-value"
class="section level3">
<h3>Is borough significantly related to the house value?</h3>
<pre class="r"><code>#Linear regression model: house value and borough
model6 &lt;- lm(house_price ~ borough, data = rodent_reg_merged)

# Creating Regression Model Table
model6 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">434080.5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">517358.1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">759697.9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">303134.7</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">216711.8</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\text{house value} =
434080.5+517358.1\times \text{Brooklyn}+759697.9\times
\text{Manhattan}+303134.7\times \text{Queens}+216711.8\times
\text{StatenIsland}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: Intercept (average
rental price in the reference category, Bronx).</li>
<li><span class="math inline">\(\beta_{1,2,3,4}\)</span>: Coefficients
for the borough dummy variables, indicating differences in house value
relative to the Bronx.</li>
</ul>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> 434080.5</p>
<p>The intercept represents the average house value in the Bronx (the
reference category).</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{1,2,3,4}\)</span>):</strong></p>
<p>These coefficients indicate how much higher the average house value
is in each borough compared to the Bronx. All positive.</p>
<p><strong>Statistical Significance:</strong></p>
<p>All borough coefficients (<span class="math inline">\(p\approx
0\)</span>) are statistically significant, indicating significant
differences in average house values between the Bronx and other
boroughs. The overall model is significant, meaning that borough is a
significant predictor of house value.</p>
<p><strong>Summary:</strong></p>
<p>Borough is significantly related to house value, reflecting
differences in property markets across New York City.</p>
</div>
<div id="regression-model-with-both-borough-and-house-value"
class="section level3">
<h3>Regression model with both borough and house value</h3>
<pre class="r"><code>#Regression model testing for confounding
model7 &lt;- glm(rodent_bi ~ borough + house_price, data = rodent_reg_merged)

# Creating Regression Model Table
model7 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.4625980364</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">-0.0589711698</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">0.0027349667</td>
<td align="right">0.5799593</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">-0.1479732293</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">-0.3335062504</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">house_price</td>
<td align="right">-0.0000000497</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\text{rodent activity} =
0.4626+(−0.0590)\times \text{Brooklyn}+(0.0027)\times
\text{Manhattan}+(−0.1480)\times \text{Queens}+(−0.3335)\times
\text{Staten Island}+(−0.000000497)\times \text{house
price}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\beta_0:\)</span> Intercept, the
baseline probability of rodent activity in the Bronx with house price =
0.</li>
<li><span class="math inline">\(\beta_{1,2,3,4}:\)</span> Coefficients
for boroughs (compared to the Bronx).</li>
<li><span class="math inline">\(\beta_5:\)</span> Coefficient for house
price, representing the effect of house price on rodent activity.</li>
</ul>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> 0.4626</p>
<p>The intercept represents the baseline probability of rodent activity
in the Bronx (the reference category) when the house price is 0.</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{1,2,3,4}\)</span>):</strong></p>
<p>These coefficients represent the difference in the probability of
rodent activity for each borough compared to the Bronx, controlling for
house price.</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{5}\)</span>):</strong> -0.000000497</p>
<p>House price has a very small negative effect on the probability of
rodent activity.</p>
<p><strong>Statistical Significance:</strong></p>
<p>Manhattan is not statistically significant (p = 0.58), but all other
borough coefficients are statistically significant (p &lt; 0.001). The
coefficient for house price is statistically significant, but the effect
size is negligible.</p>
<p><strong>Summary:</strong></p>
<p>Borough remains a significant predictor of rodent activity. House
price also has a statistically significant effect.</p>
</div>
<div id="regression-model-with-borough-rental-price-and-house-value"
class="section level3">
<h3>Regression model with borough, rental price, and house value</h3>
<pre class="r"><code>#Regression model testing for confounding
model8 &lt;- glm(rodent_bi ~ borough + rental_price + house_price, data = rodent_reg_merged)

# Creating Regression Model Table
model8 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.3864155486</td>
<td align="right">0.000000000</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">-0.0713618975</td>
<td align="right">0.000000000</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">-0.0136966681</td>
<td align="right">0.006363476</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">-0.1510194546</td>
<td align="right">0.000000000</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">-0.3252400123</td>
<td align="right">0.000000000</td>
</tr>
<tr class="even">
<td align="left">rental_price</td>
<td align="right">0.0000462109</td>
<td align="right">0.000000000</td>
</tr>
<tr class="odd">
<td align="left">house_price</td>
<td align="right">-0.0000000978</td>
<td align="right">0.000000000</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\text{rodent activity} =
0.3864+(−0.0714)\times \text{Brooklyn}+(−0.0137)\times
\text{Manhattan}+(−0.1510)\times \text{Queens}+(−0.3252)\times
\text{Staten Island}+(0.0000462)\times \text{rental
price}+(−0.000000978)\times \text{house price}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\beta_0:\)</span> Intercept,
representing the baseline probability of rodent activity in the Bronx
with rental price = 0 and house price = 0.</li>
<li><span class="math inline">\(\beta_{1,2,3,4}:\)</span> Coefficients
for boroughs (relative to the Bronx).</li>
<li><span class="math inline">\(\beta_5:\)</span> Coefficient for rental
price, representing the effect of rental price on rodent activity.</li>
<li><span class="math inline">\(\beta_6:\)</span> Coefficient for house
price, representing the effect of house price on rodent activity.</li>
</ul>
<p><strong>Intercept (<span
class="math inline">\(\beta_0\)</span>):</strong> 0.3864</p>
<p>The intercept represents the baseline probability of rodent activity
in the Bronx when rental_price=0 and house_price=0.</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{1,2,3,4}\)</span>):</strong></p>
<p>These coefficients represent the difference in the probability of
rodent activity for each borough compared to the Bronx, controlling for
rental price and house price.</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{5}\)</span>):</strong> 0.0000462</p>
<p>Rental price has a very small positive effect on the probability of
rodent activity.</p>
<p><strong>Coefficient for borough (<span
class="math inline">\(\beta_{6}\)</span>):</strong> -0.000000978</p>
<p>House price has a very small negative effect on the probability of
rodent activity.</p>
<p><strong>Statistical Significance:</strong></p>
<p>All borough coefficients are statistically significant (p&lt;0.01).
Rental price and house price are statistically significant (p=0), but
their effects are very small.</p>
<p><strong>Summary:</strong></p>
<p>Borough is a strong predictor of rodent activity. Rental price and
house price are also statistically significant.</p>
<p><strong>In conclusion, Borough remains the dominant predictor of
rodent activity in the model. Although rental price and house price are
statistically significant, their effects are too small to have practical
relevance. Here, we need to compare the models to decide which
predictors to consider.</strong></p>
</div>
<div
id="comparison-of-models-with-or-without-rental-price-and-house-value"
class="section level3">
<h3>Comparison of models with or without rental price and house
value</h3>
<pre class="r"><code>cv1_df = 
  crossv_mc(rodent_reg_merged, 100)

cv1_df |&gt; 
  mutate(
    mod_1  = map(train, \(df) glm(rodent_bi ~ borough, data = rodent_reg_merged)),
    mod_2  = map(train, \(df) glm(rodent_bi ~ borough + rental_price + house_price, 
                                  data = rodent_reg_merged))) |&gt; 
  mutate(
    rmse_1 = map2_dbl(mod_1, test, \(mod, df) rmse(model = mod, data = df)),
    rmse_2 = map2_dbl(mod_2, test, \(mod, df) rmse(model = mod, data = df))) |&gt;
  select(starts_with(&quot;rmse&quot;)) |&gt;
  pivot_longer(
    everything(), 
    names_to = &quot;model&quot;, 
    values_to = &quot;rmse&quot;, 
    names_prefix = &quot;rmse_&quot;) |&gt;
  ggplot(aes(x = model, y = rmse, group = model, fill = model)) + 
  geom_violin(alpha = 0.5) +
  theme_minimal()</code></pre>
<p><img src="regression_models_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>The model excluding rental price and house value has a much higher
root mean squared errors (RMSE) value than the model including rental
price and house value. This means that the <strong>model including
rental price and house value</strong> better fits our data.</p>
</div>
</div>
<div
id="testing-for-interaction-between-rental-price-house-value-and-borough"
class="section level2">
<h2>Testing for Interaction between rental price, house value, and
borough</h2>
<pre class="r"><code>#Regression model testing for confounding
model9 = glm(formula = rodent_bi ~ borough + rental_price + house_price + 
              borough*rental_price*house_price, data = rodent_reg_merged)

# Creating Regression Model Table
model9 |&gt;
  broom::tidy() |&gt;
  select(term, estimate, p.value) |&gt;
  knitr::kable(digits = 10)</code></pre>
<table style="width:100%;">
<colgroup>
<col width="63%" />
<col width="19%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.6955330911</td>
<td align="right">0.000000000</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">-1.4197603991</td>
<td align="right">0.000000000</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">0.0063149166</td>
<td align="right">0.934697252</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">-0.2337439883</td>
<td align="right">0.062390602</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">-2.9077449660</td>
<td align="right">0.044424454</td>
</tr>
<tr class="even">
<td align="left">rental_price</td>
<td align="right">-0.0000035076</td>
<td align="right">0.917536797</td>
</tr>
<tr class="odd">
<td align="left">house_price</td>
<td align="right">-0.0000004249</td>
<td align="right">0.008070334</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn:rental_price</td>
<td align="right">0.0003818638</td>
<td align="right">0.000000000</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan:rental_price</td>
<td align="right">-0.0000618627</td>
<td align="right">0.071637366</td>
</tr>
<tr class="even">
<td align="left">boroughQueens:rental_price</td>
<td align="right">-0.0000368845</td>
<td align="right">0.488734039</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island:rental_price</td>
<td align="right">0.0013601407</td>
<td align="right">0.065178956</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn:house_price</td>
<td align="right">0.0000011302</td>
<td align="right">0.000000000</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan:house_price</td>
<td align="right">0.0000002448</td>
<td align="right">0.128552047</td>
</tr>
<tr class="even">
<td align="left">boroughQueens:house_price</td>
<td align="right">-0.0000000407</td>
<td align="right">0.838245302</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island:house_price</td>
<td align="right">0.0000034063</td>
<td align="right">0.123142293</td>
</tr>
<tr class="even">
<td align="left">rental_price:house_price</td>
<td align="right">-0.0000000001</td>
<td align="right">0.332989979</td>
</tr>
<tr class="odd">
<td align="left">boroughBrooklyn:rental_price:house_price</td>
<td align="right">-0.0000000002</td>
<td align="right">0.015165596</td>
</tr>
<tr class="even">
<td align="left">boroughManhattan:rental_price:house_price</td>
<td align="right">0.0000000001</td>
<td align="right">0.157520150</td>
</tr>
<tr class="odd">
<td align="left">boroughQueens:rental_price:house_price</td>
<td align="right">0.0000000002</td>
<td align="right">0.013981259</td>
</tr>
<tr class="even">
<td align="left">boroughStaten Island:rental_price:house_price</td>
<td align="right">-0.0000000017</td>
<td align="right">0.116823631</td>
</tr>
</tbody>
</table>
<p>There are significant interactions between borough and rental price
as well as borough and house price, particularly in Brooklyn and Queens.
This indicates that the relationship between rental price, house price,
and rodent activity varies across different boroughs.</p>
<p>This model is considerably more complex, with numerous interaction
terms. The results suggest that while borough remains a key factor in
predicting rodent activity, the influence of rental and house prices
varies by borough. However, many of the interaction effects are not
statistically significant, implying that the added complexity may not be
providing substantial predictive improvement.</p>
<p>Therefore, we need to check further.</p>
</div>
<div id="comparison-of-models-with-and-without-interaction-term"
class="section level2">
<h2>Comparison of models with and without interaction term:</h2>
<pre class="r"><code>cv2_df = 
  crossv_mc(rodent_reg_merged, 100) 

cv2_df |&gt; 
  mutate(
    mod_1  = map(train, \(df) glm(formula = rodent_bi ~ borough + rental_price + house_price 
                                  + borough*rental_price*house_price, data = rodent_reg_merged)),
    mod_2  = map(train, \(df) glm(formula = rodent_bi ~ borough + rental_price + house_price, 
                                  data = rodent_reg_merged))) |&gt; 
  mutate(
    rmse_1 = map2_dbl(mod_1, test, \(mod, df) rmse(model = mod, data = df)),
    rmse_2 = map2_dbl(mod_2, test, \(mod, df) rmse(model = mod, data = df))) |&gt;
  select(starts_with(&quot;rmse&quot;)) |&gt;
  pivot_longer(
    everything(), 
    names_to = &quot;model&quot;, 
    values_to = &quot;rmse&quot;, 
    names_prefix = &quot;rmse_&quot;) |&gt;
  ggplot(aes(x = model, y = rmse, group = model, fill = model)) + 
  geom_violin()</code></pre>
<p><img src="regression_models_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>The model with an interaction term between borough, rental price, and
home value has a lower RMSE value than the model without an interaction
term. Ultimately, the model with interaction terms appears to be the
best model.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
